{"version":3,"file":"locator.js","sources":["../src/touchdrag.js","../src/dotmarker.js","../src/spritemarker.js","../src/geo.js","../src/index.js"],"sourcesContent":["/**\r\n * sjaakp/yii2-locator\r\n * ----------\r\n * Leaflet wrapper for Yii2 framework\r\n * Version 1.0.0\r\n * Copyright (c) 2019\r\n * Sjaak Priester, Amsterdam\r\n * MIT License\r\n * https://github.com/sjaakp/yii2-locator\r\n * https://sjaakpriester.nl\r\n */\r\n\r\n// https://leafletjs.com/examples/extending/extending-3-controls.html#handlers\r\n// https://github.com/elmarquis/Leaflet.GestureHandling\r\n\r\nL.TouchDragHandler = L.Handler.extend({\r\n    addHooks() {\r\n        this._map.dragging.disable();\r\n        if (this._map.tap) {\r\n            this._map.tap.disable();\r\n        }\r\n        this._map._container.addEventListener('touchstart', this._handleTouch);\r\n        this._map._container.addEventListener('touchend', this._handleTouch);\r\n        L.DomEvent.on(this._map._container, 'click', this._handleTouch, this);\r\n    },\r\n\r\n    removeHooks() {\r\n        this._map.dragging.enable();\r\n        if (this._map.tap) {\r\n            this._map.tap.enable();\r\n        }\r\n        this._map._container.removeEventListener('touchstart', this._handleTouch);\r\n        this._map._container.removeEventListener('touchend', this._handleTouch);\r\n        L.DomEvent.off(this._map._container, 'click', this._handleTouch, this);\r\n    },\r\n\r\n    _handleTouch(e) {\r\n        if (e.type === 'touchstart' && e.touches.length === 1)  {\r\n            L.DomUtil.addClass(e.target, 'leaflet-touchdrag');\r\n            this._map.dragging.disable();\r\n        } else {\r\n            L.DomUtil.removeClass(e.target, 'leaflet-touchdrag');\r\n            this._map.dragging.enable();\r\n        }\r\n        return true;\r\n    },\r\n});\r\n","/**\r\n * sjaakp/yii2-locator\r\n * ----------\r\n * Leaflet wrapper for Yii2 framework\r\n * Version 1.0.0\r\n * Copyright (c) 2019\r\n * Sjaak Priester, Amsterdam\r\n * MIT License\r\n * https://github.com/sjaakp/yii2-locator\r\n * https://sjaakpriester.nl\r\n */\r\n\r\nL.DotMarker = L.CircleMarker.extend({\r\n\r\n    /**\r\n     * @param latlng\r\n     * @param options options for the DotMarker:\r\n     * - 'className': HTML class of underlying SVG <path>. Notice: *not* 'class'. @link https://leafletjs.com/reference-1.6.0.html#path\r\n     */\r\n    initialize(latlng, options) {\r\n        let cl = options.className ? options.className + ' ' : '';\r\n        L.CircleMarker.prototype.initialize.call(this, latlng, Object.assign(options, {\r\n            radius: 8,\r\n            weight: 2,\r\n            fillOpacity: 1.0,\r\n            className: cl + 'dot-marker'\r\n        }));\r\n    }\r\n});\r\n\r\nL.dotMarker = function(latlng, options) {\r\n    return new L.DotMarker(latlng, options);\r\n};\r\n","/**\r\n * sjaakp/yii2-locator\r\n * ----------\r\n * Leaflet wrapper for Yii2 framework\r\n * Version 1.0.0\r\n * Copyright (c) 2019\r\n * Sjaak Priester, Amsterdam\r\n * MIT License\r\n * https://github.com/sjaakp/yii2-locator\r\n * https://sjaakpriester.nl\r\n */\r\n\r\nL.SpriteMarker = L.Marker.extend({\r\n\r\n    /**\r\n     * @param latlng\r\n     * @param options options for the SpriteMarker:\r\n     * - 'html': content of SpriteMarker; default empty. @link https://leafletjs.com/reference-1.6.0.html#divicon\r\n     * - 'className': HTML class of DIV. Notice: *not* 'class'. @link https://leafletjs.com/reference-1.6.0.html#divicon-classname\r\n     * Use this to display FontAwesome markers like so: 'className': 'far fa-2x fa-dog'; leave 'html' unset.\r\n     */\r\n    initialize(latlng, options) {\r\n        let cl = options.className ? options.className + ' ' : '';\r\n        options.icon = L.divIcon({\r\n            html: options.html || false,\r\n            iconSize: options.iconSize || 24,\r\n            bgPos: options.bgPos || null,\r\n            className: cl + 'sprite-marker'\r\n        });\r\n        L.Marker.prototype.initialize.call(this, latlng, options);\r\n    },\r\n});\r\n\r\nL.spriteMarker = function(latlng, options) {\r\n    return new L.SpriteMarker(latlng, options);\r\n};\r\n","/**\r\n * sjaakp/yii2-locator\r\n * ----------\r\n * Leaflet wrapper for Yii2 framework\r\n * Version 1.0.0\r\n * Copyright (c) 2020\r\n * Sjaak Priester, Amsterdam\r\n * MIT License\r\n * https://github.com/sjaakp/yii2-locator\r\n * https://sjaakpriester.nl\r\n */\r\n\r\nL.geo = {\r\n    Geocoder: L.Class.extend({\r\n        initialize: function (map, options) {\r\n            this._map = map;\r\n            L.setOptions(this, options);\r\n        },\r\n\r\n        constructUrl(text, options = {})  {\r\n            const opts = Object.assign({}, this.options, options),\r\n                url = new URL(text);\r\n            for (const k in opts)   {\r\n                url.searchParams.set(k, opts[k]);\r\n            }\r\n            return url;\r\n        },\r\n\r\n        fetchJson(url)  {\r\n            return fetch(url.href)\r\n                .then(response => response.json())\r\n        },\r\n\r\n        placeMarker(latlng, bbox)   {\r\n            this._map.placeMarker(latlng, bbox);\r\n        },\r\n\r\n        fire(err)   {\r\n            this._map.fire(err);\r\n        },\r\n\r\n        suggest(address, datalist)    {\r\n        },\r\n\r\n        lookup(id)  {\r\n        }\r\n    })\r\n};\r\n\r\n/**\r\n * @link https://nominatim.org/release-docs/develop/api/Search/\r\n */\r\nL.geo.Nominatim = L.geo.Geocoder.extend({\r\n    url: 'https://nominatim.openstreetmap.org/',\r\n\r\n    mark(place) {\r\n        const latlng = L.latLng(place.lat, place.lon),\r\n            bb = place.boundingbox,\r\n            bbox = L.latLngBounds([bb[0], bb[2]], [bb[1], bb[3]]);\r\n        this.placeMarker(latlng, bbox);\r\n    },\r\n\r\n    search(address) {\r\n        const url = this.constructUrl(this.url + 'search', { format: 'json', q: address });\r\n        return this.fetchJson(url)\r\n    },\r\n\r\n    suggest(address, datalist)    {\r\n        // const url = this.constructUrl(this.url + 'search', { format: 'json', q: address });\r\n        this.search(address)\r\n            .then(json => {\r\n                // console.log(json);\r\n                datalist.innerHTML = json.reduce((a, v) => a + `<option data-id=\"${v.osm_type.charAt(0).toUpperCase()}${v.osm_id}\">${v.display_name}</option>`, '');\r\n            })\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    lookup(id)  {\r\n        const url = this.constructUrl(this.url + 'reverse', {\r\n            format: 'json',\r\n            osm_type: id.charAt(0),\r\n            osm_id: id.slice(1)\r\n        });\r\n        this.fetchJson(url)\r\n            .then(json => this.mark(json))\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    geocode(address)    {\r\n        // fetch('//nominatim.openstreetmap.org/search?format=json&q=' + encodeURIComponent(address))\r\n        //     .then(response => response.json())\r\n        this.search(address)\r\n            .then(json => {\r\n                if (json.length < 1) throw('notfound');\r\n                return json[0];\r\n            })\r\n            .then(place => this.mark(place))\r\n            .catch(error => this.fire(error));\r\n    }\r\n});\r\n\r\n/**\r\n * @link https://developer.here.com/documentation/geocoder/dev_guide/topics/request-constructing.html\r\n */\r\nL.geo.Here = L.geo.Geocoder.extend({\r\n    mark(place) {\r\n        const pos = place.displayPosition,\r\n            latlng = L.latLng(pos.latitude, pos.longitude),\r\n            mapv = place.mapView,\r\n            tl = mapv.topLeft,\r\n            br = mapv.bottomRight,\r\n            bbox = L.latLngBounds([tl.latitude, br.longitude], [br.latitude, tl.longitude]);\r\n        this.placeMarker(latlng, bbox);\r\n    },\r\n\r\n    fetchData(options)  {\r\n        options.jsonattributes = 1;\r\n        const url = this.constructUrl('https://geocoder.ls.hereapi.com/6.2/geocode.json', options);\r\n        this.fetchJson(url)\r\n            .then(json => json.response.view.shift().result.shift())\r\n            .then(result => this.mark(result.location))\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    suggest(address, datalist)  {\r\n        const url = this.constructUrl('https://autocomplete.geocoder.ls.hereapi.com/6.2/suggest.json', { query: address });\r\n        this.fetchJson(url)\r\n            .then(json => json.suggestions)\r\n            .then(suggestions => {\r\n                datalist.innerHTML = suggestions.reduce((a, v) => a + `<option data-id=\"${v.locationId}\">${v.label}</option>`, '');\r\n            })\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    lookup(id)  {\r\n        this.fetchData({ locationid: id });\r\n    },\r\n\r\n    geocode(address)    {\r\n        this.fetchData({ searchtext: address });\r\n    }\r\n});\r\n\r\n/**\r\n * Topological names only; no streets\r\n * @link http://www.geonames.org/export/geonames-search.html\r\n */\r\nL.geo.GeoNames = L.geo.Geocoder.extend({\r\n    url: 'http://api.geonames.org/search',  // no https!\r\n\r\n    fetchGeonames(url)  {\r\n        return this.fetchJson(url)\r\n            .then(json => {\r\n                const geonames = json.geonames;\r\n                if (! geonames || geonames.length < 1) throw 'notfound';\r\n                return geonames;\r\n            })\r\n    },\r\n\r\n    mark(place) {\r\n        const latlng = L.latLng(place.lat, place.lng),\r\n            bb = place.bbox,\r\n            bbox = L.latLngBounds([bb.north, bb.west], [bb.south, bb.east]);\r\n        this.placeMarker(latlng, bbox);\r\n    },\r\n\r\n    suggest(address, datalist)    {\r\n        const url = this.constructUrl(this.url, { q: address, type: 'json', style: 'short' });\r\n\r\n        this.fetchGeonames(url)\r\n            .then(geonames => {\r\n                datalist.innerHTML = geonames.reduce((a, v) => a + `<option data-id=\"${v.geonameId}\">${v.name}&emsp;${v.countryCode}</option>`, '');\r\n            })\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    lookup(id)  {\r\n        const url = this.constructUrl('http://api.geonames.org/getJSON', { geonameId: id });\r\n\r\n        this.fetchJson(url)\r\n            .then(json => this.mark(json))\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    geocode(address)    {\r\n        const url = this.constructUrl(this.url, { q: address, inclBbox: true });\r\n\r\n        this.fetchGeonames(url)\r\n            .then(geonames => geonames.shift())\r\n            .then(place => this.mark(place))\r\n            .catch(error => this.fire(error));\r\n    }\r\n});\r\n\r\n/**\r\n * @link https://developer.tomtom.com/search-api-and-extended-search-api/search-api-and-extended-search-api-documentation-geocoding/geocode\r\n */\r\nL.geo.TomTom = L.geo.Geocoder.extend({\r\n    url: 'https://api.tomtom.com/search/2/geocode/',\r\n\r\n    suggestions: [],\r\n\r\n    datalist: null,\r\n\r\n    mark(place) {\r\n        const pos = place.position,\r\n            latlng = L.latLng(pos.lat, pos.lon),\r\n            mapv = place.viewport,\r\n            tl = mapv.topLeftPoint,\r\n            br = mapv.btmRightPoint,\r\n            bbox = L.latLngBounds([tl.lat, br.lon], [br.lat, tl.lon]);\r\n        this.placeMarker(latlng, bbox);\r\n    },\r\n\r\n    fetchResults(address, options = {})  {\r\n        const query = encodeURIComponent(address),\r\n            url = this.constructUrl(`${this.url}${query}.json`, options);\r\n\r\n        return this.fetchJson(url)\r\n            .then(json => {\r\n                if (json.summary.numResults < 1) throw('notfound');\r\n                return json.results;\r\n            })\r\n    },\r\n\r\n    suggest(address, datalist)  {\r\n        this.datalist = datalist;\r\n        this.fetchResults(address,{ typeahead: true })\r\n            .then(results => {\r\n                this.suggestions = results;\r\n                datalist.innerHTML = results.reduce((a, v) => a + `<option data-id=\"${v.id}\">${v.address.freeformAddress}</option>`, '');\r\n            })\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    lookup(id)  {\r\n        const found = this.suggestions.find(v => v.id === id);\r\n        if (found) this.mark(found);\r\n    },\r\n\r\n    geocode(address)    {\r\n        this.fetchResults(address)\r\n            .then(results => results.shift())\r\n            .then(place => this.mark(place))\r\n            .catch(error => this.fire(error));\r\n    }\r\n});\r\n\r\n/**\r\n * Netherlands\r\n * @link https://github.com/PDOK/locatieserver/wiki/API-Locatieserver\r\n */\r\nL.geo.Kadaster = L.geo.Geocoder.extend({\r\n    url: 'https://geodata.nationaalgeoregister.nl/locatieserver/v3/',\r\n\r\n    mark(place) {\r\n        this.placeMarker(place.centroide_ll.match(/[\\d.]+/g).reverse());\r\n    },\r\n\r\n    suggest(address, datalist)  {\r\n        const url = this.constructUrl(this.url + 'suggest', { q: address + ' and -type:postcode' });\r\n        this.fetchJson(url)\r\n            .then(json => {\r\n                if (json.response.numFound < 1) throw('notfound');\r\n                return json.highlighting;\r\n            })\r\n            .then(hilight => {\r\n                let html = '';\r\n                for (const id in hilight) {\r\n                    const opt = `<option data-id=\"${id}\">${hilight[id].suggest.shift()}</option>`;\r\n                    html += opt;\r\n                }\r\n                datalist.innerHTML = html;\r\n            })\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    lookup(id)  {\r\n        const url = this.constructUrl(this.url + 'lookup', { id: id });\r\n        this.fetchJson(url)\r\n            .then(json => json.response.docs.shift())\r\n            .then(place => this.mark(place))\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    geocode(address)    {\r\n        const url = this.constructUrl(this.url + 'free', { q: address + ' and -type:postcode' });\r\n        this.fetchJson(url)\r\n            .then(json => {\r\n                if (json.response.numFound < 1) throw('notfound');\r\n                return json.response.docs.shift();\r\n            })\r\n            .then(place => this.mark(place))\r\n            .catch(error => this.fire(error));\r\n    }\r\n});\r\n\r\nL.Search = L.Control.extend({\r\n    initialize(options) {\r\n        L.setOptions(this, options || {});\r\n    },\r\n\r\n    onAdd(map)  {\r\n        const datalistId = map.getContainer().id + '_dl';\r\n        const container = L.DomUtil.create('div', 'locator-search');\r\n        const input = L.DomUtil.create('input', null, container);\r\n        input.type = 'text';\r\n        input.setAttribute('list', datalistId);\r\n        L.DomEvent.on(input, 'input', function (e) {\r\n            const v = e.target.value;\r\n            if (v.length >= 2)  {\r\n                this._geocoder.suggest(e.target.value, datalist);\r\n            }\r\n        }, map);\r\n        L.DomEvent.on(input, 'change', function (e) {\r\n            const val = e.target.value,\r\n                opts = datalist.childNodes;\r\n            e.target.value = '';\r\n            container.classList.remove('open');\r\n            for (let i = 0; i < opts.length; i++) {\r\n                if (val.startsWith(opts[i].innerText)) {\r\n                    this._geocoder.lookup(opts[i].dataset.id);\r\n                    return;\r\n                }\r\n            }\r\n            this.find(val);\r\n        }, map);\r\n        const button = L.DomUtil.create('button', null, container);\r\n        button.innerHTML = '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 512 512\"><path d=\"M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z\"/></svg>';\r\n        button.title = 'Search';\r\n        L.DomEvent.on(button, 'click', function(e) {\r\n            e.preventDefault();\r\n            this.toggle();\r\n        }, this);\r\n        const datalist = L.DomUtil.create('datalist', null, container);\r\n        datalist.id = datalistId;\r\n        return container;\r\n    },\r\n\r\n    toggle()  {\r\n        const c = this.getContainer(),\r\n            cc = c.classList,\r\n            bOpen = cc.contains('open');\r\n        cc.toggle('open');\r\n        if (! bOpen)  {\r\n            c.children[0].focus();\r\n        }\r\n    },\r\n});\r\n\r\nL.search = function(options) {\r\n    return new L.Search(options);\r\n};\r\n\r\nL.Map.include({\r\n    find(address) {\r\n        this._geocoder.geocode(address);\r\n        return this;\r\n    },\r\n\r\n    geocoder(name, options)  {\r\n        this._geocoder = new L.geo[name](this, options);\r\n        return this;\r\n    },\r\n\r\n    finder(options)  {\r\n        this.addControl(L.search(options));\r\n    }\r\n});\r\n\r\nL.Map.addInitHook(function() {\r\n    this.geocoder('Nominatim', {});\r\n});\r\n","/**\r\n * sjaakp/yii2-locator\r\n * ----------\r\n * Leaflet wrapper for Yii2 framework\r\n * Version 1.0.0\r\n * Copyright (c) 2020\r\n * Sjaak Priester, Amsterdam\r\n * MIT License\r\n * https://github.com/sjaakp/yii2-locator\r\n * https://sjaakpriester.nl\r\n */\r\n\r\n/*\r\n    Plugin for Leaflet\r\n    Tested with Leaflet 1.6.0\r\n    21-05-2018 ... 29-12-2019\r\n\r\n    Map has extra options:\r\n        marker      Plain object, options used for creating markers\r\n                        the option 'type' determines the type of marker (Marker, CircleMarker, DotMarker, SpriteMarker)\r\n                        the option 'icon' is a plain object with options to create the icon for a regular Marker (i.e. not the icon itself)\r\n        urlTemplate     String, url jumped to or used to get popup contents when marker is clicked. If not set, no jump is performed.\r\n                        '{xxx}' gets replaced by Marker option <xxx>\r\n                        typical use: urlTemplate = '/view/{id}'\r\n        cluster     null|object. MarkerClusterer options; null: no clusters.\r\n        popup       null|object. Popup options; null: no popups.\r\n        touchdrag   Boolean. If true, map can only be panned with two fingers; warning overlay appears if attempted with one finger.\r\n                        Intended to avoid conflict with page scrolling on small devices.\r\n        scale       null: no scale | 1: metric scale | 2: imperial scale | 3: both.\r\n\r\n    Two new classes:\r\n\r\n    DotMarker is an extension of CircleMarker. It gets the HTML class 'dot-marker'.\r\n\r\n    SpriteMarker is a Marker with a DivIcon. It has all the options of DivIcon. It gets the HTML class 'sprite-marker'.\r\n        Typical use: set the 'html' option to a SVG-element, either with an explicit path or a use class; use the option 'className' to colorize the sprite\r\n\r\n    Marker, CircleMarker, DotMarker, SpriteMarker each have extra options\r\n        monitor     String, the id of a HTML text input updated at moveend\r\n        title       HTML of tooltip\r\n\r\n    @link https://leafletjs.com/\r\n    @link http://www.liedman.net/tiled-maps/ - The Hitchhacker’s Guide To Tiled Maps\r\n */\r\n\r\nimport './locator.scss';\r\nimport './touchdrag.js';\r\nimport './dotmarker.js';\r\nimport './spritemarker.js';\r\nimport './geo.js';\r\n\r\nL.Map.addInitHook(function() {\r\n    if (this.options.scale !== null) {\r\n        const s = this.options.scale,\r\n            metric = s & 1,\r\n            imperial = s & 2;\r\n        this.addControl(L.control.scale({ metric: metric, imperial: imperial }));    // add scale control\r\n    }\r\n    if (this.options.touchdrag) this.addHandler('touchdrag', L.TouchDragHandler);       // and touchdrag handler\r\n});\r\n\r\n\r\nL.Map.include({\r\n\r\n    _markers: null,\r\n    _armed: false,      // true if click on map produces a marker\r\n\r\n    getMarkers()  {\r\n        if (! this._markers)    {\r\n            if (this.options.cluster !== null)  {\r\n                this._markers = L.markerClusterGroup(this.options.cluster);\r\n                this.addLayer(this._markers);\r\n            }\r\n            else this._markers = this;\r\n        }\r\n        return this._markers;\r\n    },\r\n\r\n    arm(markerOpts) {       // prepare for marker on click\r\n        if (! this._armed)  {\r\n            L.DomUtil.addClass(this.getContainer(), 'locator-armed');\r\n            this.options.marker = markerOpts;\r\n            this.on('click', function(e) {\r\n                this.disarm();\r\n                return this.addMarker(e.latlng, markerOpts);\r\n            });\r\n            this._armed = true;\r\n        }\r\n        return this;\r\n    },\r\n\r\n    disarm() {\r\n        if (this._armed)    {\r\n            L.DomUtil.removeClass(this.getContainer(), 'locator-armed');\r\n            this.off('click');\r\n            this._armed = false;\r\n        }\r\n        return this;\r\n    },\r\n\r\n    addFeature(feature)   {\r\n        this.getMarkers().addLayer(L.geoJSON(feature, {\r\n            pointToLayer: function(ft, latlng) {\r\n                return this.newMarker(latlng, Object.assign({}, this.options.marker, ft.properties));\r\n            }.bind(this),\r\n        }));\r\n        return this;\r\n    },\r\n\r\n    monitorZoom(id) {\r\n        return this.on('zoomend', function(e) {\r\n            document.getElementById(id).value = e.target.getZoom();\r\n        }).fire('zoomend');\r\n    },\r\n\r\n    monitorCenter(id) {\r\n        return this.on('moveend', function(e) {\r\n            const c = e.target.getCenter();\r\n            document.getElementById(id).value = JSON.stringify({\r\n                type: 'Point',\r\n                coordinates: [c.lng, c.lat]\r\n            });\r\n        }).fire('moveend');\r\n    },\r\n\r\n    newMarker(latlng, options) {      // create a new marker of any type\r\n        const type = options.type || 'Marker';\r\n        if (type === 'Marker' && options.icon)  {\r\n            options.icon = L.icon(options.icon);\r\n        }\r\n        let r = new L[type](latlng, options).on('moveend', function(e) {\r\n            const id = e.target.options.monitor;\r\n            if (id) {\r\n                document.getElementById(id).value = JSON.stringify(e.target.toGeoJSON());\r\n            }\r\n        }).on('click', function (e)    {\r\n            let url = this.options.urlTemplate;\r\n            if (url)  {\r\n                let matches = url.match(/{\\w+}/g);\r\n                if (matches)    {\r\n                    matches.forEach(function(match) {\r\n                        url = url.replace(match, e.target.options[match.slice(1, -1)]);\r\n                    }, this);\r\n                }\r\n                if (this.options.popup !== null)   {\r\n                    const pOpts = this.options.popup,\r\n                        popup = L.popup(pOpts).setLatLng(e.latlng).setContent(pOpts.loading).openOn(this);\r\n\r\n                    fetch(url)\r\n                        .then(response => response.text())\r\n                        .then(html => popup.setContent(html));\r\n                }\r\n                else    {\r\n                    window.location = url;\r\n                }\r\n            }\r\n        }, this);   // context = map\r\n\r\n        if (options.title)  {\r\n            r.bindTooltip(options.title);\r\n        }\r\n        return r;\r\n    },\r\n\r\n    addMarker(latlng, markerOpts)  {\r\n        const m = this.newMarker(latlng, markerOpts);\r\n        this.addLayer(m);\r\n        this._marker = m;\r\n        m.fire('moveend');\r\n        return this;\r\n    },\r\n\r\n    placeMarker(latlng, bbox)   {\r\n        if (this._marker)    {\r\n            this._marker.setLatLng(latlng);\r\n        }\r\n        else {\r\n            this.disarm().addMarker(latlng, this.options.marker);\r\n        }\r\n        if (this.options.fly)   {\r\n            if (bbox) this.flyToBounds(bbox);\r\n            else this.flyTo(latlng);\r\n        } else  {\r\n            if (bbox) this.fitBounds(bbox);\r\n            else this.panTo(latlng);\r\n        }\r\n    },\r\n});\r\n"],"names":["L","TouchDragHandler","Handler","extend","addHooks","this","_map","dragging","disable","tap","_container","addEventListener","_handleTouch","DomEvent","on","removeHooks","enable","removeEventListener","off","e","type","touches","length","DomUtil","addClass","target","removeClass","DotMarker","CircleMarker","initialize","latlng","options","let","cl","className","prototype","call","Object","assign","radius","weight","fillOpacity","dotMarker","SpriteMarker","Marker","icon","divIcon","html","iconSize","bgPos","spriteMarker","geo","Geocoder","Class","map","setOptions","constructUrl","text","const","opts","url","URL","k","searchParams","set","fetchJson","fetch","href","then","response","json","placeMarker","bbox","fire","err","suggest","address","datalist","lookup","id","Nominatim","mark","place","latLng","lat","lon","bb","boundingbox","latLngBounds","search","format","q","innerHTML","reduce","a","v","osm_type","charAt","toUpperCase","catch","error","osm_id","slice","geocode","Here","pos","displayPosition","latitude","longitude","mapv","mapView","tl","topLeft","br","bottomRight","fetchData","jsonattributes","view","shift","result","location","query","suggestions","locationid","searchtext","GeoNames","fetchGeonames","geonames","lng","north","west","south","east","style","geonameId","inclBbox","TomTom","position","viewport","topLeftPoint","btmRightPoint","fetchResults","encodeURIComponent","summary","numResults","results","typeahead","found","find","Kadaster","centroide_ll","match","reverse","numFound","highlighting","hilight","docs","Search","Control","onAdd","datalistId","getContainer","container","create","input","setAttribute","value","_geocoder","val","childNodes","classList","remove","i","startsWith","innerText","dataset","button","title","preventDefault","toggle","c","cc","bOpen","contains","children","focus","Map","include","geocoder","name","finder","addControl","addInitHook","scale","s","metric","imperial","control","touchdrag","addHandler","_markers","_armed","getMarkers","cluster","markerClusterGroup","addLayer","arm","markerOpts","marker","disarm","addMarker","addFeature","feature","geoJSON","pointToLayer","ft","newMarker","properties","bind","monitorZoom","document","getElementById","getZoom","monitorCenter","getCenter","JSON","stringify","coordinates","r","monitor","toGeoJSON","urlTemplate","matches","forEach","replace","popup","pOpts","setLatLng","setContent","loading","openOn","window","bindTooltip","m","_marker","fly","flyToBounds","flyTo","fitBounds","panTo"],"mappings":"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"}