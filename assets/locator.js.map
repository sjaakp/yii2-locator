{"version":3,"file":"locator.js","sources":["../src/touchdrag.js","../src/dotmarker.js","../src/spritemarker.js","../src/geo.js","../src/index.js"],"sourcesContent":["/**\r\n * sjaakp/yii2-locator\r\n * ----------\r\n * Leaflet wrapper for Yii2 framework\r\n * Version 1.0.0\r\n * Copyright (c) 2019\r\n * Sjaak Priester, Amsterdam\r\n * MIT License\r\n * https://github.com/sjaakp/yii2-locator\r\n * https://sjaakpriester.nl\r\n */\r\n\r\n// https://leafletjs.com/examples/extending/extending-3-controls.html#handlers\r\n// https://github.com/elmarquis/Leaflet.GestureHandling\r\n\r\nL.TouchDragHandler = L.Handler.extend({\r\n    addHooks() {\r\n        this._map.dragging.disable();\r\n        if (this._map.tap) {\r\n            this._map.tap.disable();\r\n        }\r\n        this._map._container.addEventListener('touchstart', this._handleTouch);\r\n        this._map._container.addEventListener('touchend', this._handleTouch);\r\n        L.DomEvent.on(this._map._container, 'click', this._handleTouch, this);\r\n    },\r\n\r\n    removeHooks() {\r\n        this._map.dragging.enable();\r\n        if (this._map.tap) {\r\n            this._map.tap.enable();\r\n        }\r\n        this._map._container.removeEventListener('touchstart', this._handleTouch);\r\n        this._map._container.removeEventListener('touchend', this._handleTouch);\r\n        L.DomEvent.off(this._map._container, 'click', this._handleTouch, this);\r\n    },\r\n\r\n    _handleTouch(e) {\r\n        if (e.type === 'touchstart' && e.touches.length === 1)  {\r\n            L.DomUtil.addClass(e.target, 'leaflet-touchdrag');\r\n            this._map.dragging.disable();\r\n        } else {\r\n            L.DomUtil.removeClass(e.target, 'leaflet-touchdrag');\r\n            this._map.dragging.enable();\r\n        }\r\n        return true;\r\n    },\r\n});\r\n","/**\r\n * sjaakp/yii2-locator\r\n * ----------\r\n * Leaflet wrapper for Yii2 framework\r\n * Version 1.0.0\r\n * Copyright (c) 2019\r\n * Sjaak Priester, Amsterdam\r\n * MIT License\r\n * https://github.com/sjaakp/yii2-locator\r\n * https://sjaakpriester.nl\r\n */\r\n\r\nL.DotMarker = L.CircleMarker.extend({\r\n\r\n    /**\r\n     * @param latlng\r\n     * @param options options for the DotMarker:\r\n     * - 'className': HTML class of underlying SVG <path>. Notice: *not* 'class'. @link https://leafletjs.com/reference-1.6.0.html#path\r\n     */\r\n    initialize(latlng, options) {\r\n        let cl = options.className ? options.className + ' ' : '';\r\n        L.CircleMarker.prototype.initialize.call(this, latlng, Object.assign(options, {\r\n            radius: 8,\r\n            weight: 2,\r\n            fillOpacity: 1.0,\r\n            className: cl + 'dot-marker'\r\n        }));\r\n    }\r\n});\r\n\r\nL.dotMarker = function(latlng, options) {\r\n    return new L.DotMarker(latlng, options);\r\n};\r\n","/**\r\n * sjaakp/yii2-locator\r\n * ----------\r\n * Leaflet wrapper for Yii2 framework\r\n * Version 1.0.0\r\n * Copyright (c) 2019\r\n * Sjaak Priester, Amsterdam\r\n * MIT License\r\n * https://github.com/sjaakp/yii2-locator\r\n * https://sjaakpriester.nl\r\n */\r\n\r\nL.SpriteMarker = L.Marker.extend({\r\n\r\n    /**\r\n     * @param latlng\r\n     * @param options options for the SpriteMarker:\r\n     * - 'html': content of SpriteMarker; default empty. @link https://leafletjs.com/reference-1.6.0.html#divicon\r\n     * - 'className': HTML class of DIV. Notice: *not* 'class'. @link https://leafletjs.com/reference-1.6.0.html#divicon-classname\r\n     * Use this to display FontAwesome markers like so: 'className': 'far fa-2x fa-dog'; leave 'html' unset.\r\n     */\r\n    initialize(latlng, options) {\r\n        let cl = options.className ? options.className + ' ' : '';\r\n        options.icon = L.divIcon({\r\n            html: options.html || false,\r\n            iconSize: options.iconSize || 24,\r\n            bgPos: options.bgPos || null,\r\n            className: cl + 'sprite-marker'\r\n        });\r\n        L.Marker.prototype.initialize.call(this, latlng, options);\r\n    },\r\n});\r\n\r\nL.spriteMarker = function(latlng, options) {\r\n    return new L.SpriteMarker(latlng, options);\r\n};\r\n","/**\r\n * sjaakp/yii2-locator\r\n * ----------\r\n * Leaflet wrapper for Yii2 framework\r\n * Version 1.0.0\r\n * Copyright (c) 2020\r\n * Sjaak Priester, Amsterdam\r\n * MIT License\r\n * https://github.com/sjaakp/yii2-locator\r\n * https://sjaakpriester.nl\r\n */\r\n\r\nL.geo = {\r\n    Geocoder: L.Class.extend({\r\n        initialize: function (map, options) {\r\n            this._map = map;\r\n            L.setOptions(this, options);\r\n        },\r\n\r\n        constructUrl(text, options = {})  {\r\n            const opts = Object.assign({}, this.options, options),\r\n                url = new URL(text);\r\n            for (const k in opts)   {\r\n                url.searchParams.set(k, opts[k]);\r\n            }\r\n            return url;\r\n        },\r\n\r\n        fetchJson(url)  {\r\n            return fetch(url.href)\r\n                .then(response => response.json())\r\n        },\r\n\r\n        placeMarker(latlng, bbox)   {\r\n            this._map.placeMarker(latlng, bbox);\r\n        },\r\n\r\n        fire(err)   {\r\n            this._map.fire(err);\r\n        },\r\n\r\n        suggest(address, datalist)    {\r\n        },\r\n\r\n        lookup(id)  {\r\n        }\r\n    })\r\n};\r\n\r\n/**\r\n * @link https://nominatim.org/release-docs/develop/api/Search/\r\n * Doesn't support suggestions\r\n */\r\nL.geo.Nominatim = L.geo.Geocoder.extend({\r\n    mark(place) {\r\n        const latlng = L.latLng(place.lat, place.lon),\r\n            bb = place.boundingbox,\r\n            bbox = L.latLngBounds([bb[0], bb[2]], [bb[1], bb[3]]);\r\n        this.placeMarker(latlng, bbox);\r\n    },\r\n\r\n    geocode(address)    {\r\n        fetch('//nominatim.openstreetmap.org/search?format=json&q=' + encodeURIComponent(address))\r\n            .then(response => response.json())\r\n            .then(json => {\r\n                if (json.length < 1) throw('notfound');\r\n                return json[0];\r\n            })\r\n            .then(place => this.mark(place))\r\n            .catch(error => this.fire(error));\r\n    }\r\n});\r\n\r\n/**\r\n * @link https://developer.here.com/documentation/geocoder/dev_guide/topics/request-constructing.html\r\n */\r\nL.geo.Here = L.geo.Geocoder.extend({\r\n    mark(place) {\r\n        const pos = place.displayPosition,\r\n            latlng = L.latLng(pos.latitude, pos.longitude),\r\n            mapv = place.mapView,\r\n            tl = mapv.topLeft,\r\n            br = mapv.bottomRight,\r\n            bbox = L.latLngBounds([tl.latitude, br.longitude], [br.latitude, tl.longitude]);\r\n        this.placeMarker(latlng, bbox);\r\n    },\r\n\r\n    fetchData(options)  {\r\n        options.jsonattributes = 1;\r\n        const url = this.constructUrl('https://geocoder.ls.hereapi.com/6.2/geocode.json', options);\r\n        this.fetchJson(url)\r\n            .then(json => json.response.view.shift().result.shift())\r\n            .then(result => this.mark(result.location))\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    suggest(address, datalist)  {\r\n        const url = this.constructUrl('https://autocomplete.geocoder.ls.hereapi.com/6.2/suggest.json', { query: address });\r\n        this.fetchJson(url)\r\n            .then(json => json.suggestions)\r\n            .then(suggestions => {\r\n                datalist.innerHTML = suggestions.reduce((a, v) => a + `<option data-id=\"${v.locationId}\">${v.label}</option>`, '');\r\n            })\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    lookup(id)  {\r\n        this.fetchData({ locationid: id });\r\n    },\r\n\r\n    geocode(address)    {\r\n        this.fetchData({ searchtext: address });\r\n    }\r\n});\r\n\r\n/**\r\n * Topological names only; no streets\r\n * @link http://www.geonames.org/export/geonames-search.html\r\n */\r\nL.geo.GeoNames = L.geo.Geocoder.extend({\r\n    url: 'http://api.geonames.org/search',  // no https!\r\n\r\n    fetchGeonames(url)  {\r\n        return this.fetchJson(url)\r\n            .then(json => {\r\n                const geonames = json.geonames;\r\n                if (! geonames || geonames.length < 1) throw 'notfound';\r\n                return geonames;\r\n            })\r\n    },\r\n\r\n    mark(place) {\r\n        const latlng = L.latLng(place.lat, place.lng),\r\n            bb = place.bbox,\r\n            bbox = L.latLngBounds([bb.north, bb.west], [bb.south, bb.east]);\r\n        this.placeMarker(latlng, bbox);\r\n    },\r\n\r\n    suggest(address, datalist)    {\r\n        const url = this.constructUrl(this.url, { q: address, type: 'json', style: 'short' });\r\n\r\n        this.fetchGeonames(url)\r\n            .then(geonames => {\r\n                datalist.innerHTML = geonames.reduce((a, v) => a + `<option data-id=\"${v.geonameId}\">${v.name}&emsp;${v.countryCode}</option>`, '');\r\n            })\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    lookup(id)  {\r\n        const url = this.constructUrl('http://api.geonames.org/getJSON', { geonameId: id });\r\n\r\n        this.fetchJson(url)\r\n            .then(json => this.mark(json))\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    geocode(address)    {\r\n        const url = this.constructUrl(this.url, { q: address, inclBbox: true });\r\n\r\n        this.fetchGeonames(url)\r\n            .then(geonames => geonames.shift())\r\n            .then(place => this.mark(place))\r\n            .catch(error => this.fire(error));\r\n    }\r\n});\r\n\r\n/**\r\n * @link https://developer.tomtom.com/search-api-and-extended-search-api/search-api-and-extended-search-api-documentation-geocoding/geocode\r\n */\r\nL.geo.TomTom = L.geo.Geocoder.extend({\r\n    url: 'https://api.tomtom.com/search/2/geocode/',\r\n\r\n    suggestions: [],\r\n\r\n    datalist: null,\r\n\r\n    mark(place) {\r\n        const pos = place.position,\r\n            latlng = L.latLng(pos.lat, pos.lon),\r\n            mapv = place.viewport,\r\n            tl = mapv.topLeftPoint,\r\n            br = mapv.btmRightPoint,\r\n            bbox = L.latLngBounds([tl.lat, br.lon], [br.lat, tl.lon]);\r\n        this.placeMarker(latlng, bbox);\r\n    },\r\n\r\n    fetchResults(address)  {\r\n        const query = encodeURIComponent(address),\r\n            url = this.constructUrl(`${this.url}${query}.json`, { typeahead: true });\r\n\r\n        return this.fetchJson(url)\r\n            .then(json => {\r\n                if (json.summary.numResults < 1) throw('notfound');\r\n                return json.results;\r\n            })\r\n    },\r\n\r\n    suggest(address, datalist)  {\r\n        this.datalist = datalist;\r\n        this.fetchResults(address)\r\n            .then(results => {\r\n                this.suggestions = results;\r\n                datalist.innerHTML = results.reduce((a, v) => a + `<option data-id=\"${v.id}\">${v.address.freeformAddress}</option>`, '');\r\n            })\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    lookup(id)  {\r\n        const found = this.suggestions.find(v => v.id === id);\r\n        if (found) this.mark(found);\r\n    },\r\n\r\n    geocode(address)    {\r\n        this.fetchResults(address)\r\n            .then(results => results.shift())\r\n            .then(place => this.mark(place))\r\n            .catch(error => this.fire(error));\r\n    }\r\n});\r\n\r\n/**\r\n * Netherlands\r\n * @link https://github.com/PDOK/locatieserver/wiki/API-Locatieserver\r\n */\r\nL.geo.Kadaster = L.geo.Geocoder.extend({\r\n    url: 'https://geodata.nationaalgeoregister.nl/locatieserver/v3/',\r\n\r\n    mark(place) {\r\n        this.placeMarker(place.centroide_ll.match(/[\\d.]+/g).reverse());\r\n    },\r\n\r\n    suggest(address, datalist)  {\r\n        const url = this.constructUrl(this.url + 'suggest', { q: address + ' and -type:postcode' });\r\n        this.fetchJson(url)\r\n            .then(json => {\r\n                if (json.response.numFound < 1) throw('notfound');\r\n                return json.highlighting;\r\n            })\r\n            .then(hilight => {\r\n                let html = '';\r\n                for (const id in hilight) {\r\n                    const opt = `<option data-id=\"${id}\">${hilight[id].suggest.shift()}</option>`;\r\n                    html += opt;\r\n                }\r\n                datalist.innerHTML = html;\r\n            })\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    lookup(id)  {\r\n        const url = this.constructUrl(this.url + 'lookup', { id: id });\r\n        this.fetchJson(url)\r\n            .then(json => json.response.docs.shift())\r\n            .then(place => this.mark(place))\r\n            .catch(error => this.fire(error));\r\n    },\r\n\r\n    geocode(address)    {\r\n        const url = this.constructUrl(this.url + 'free', { q: address + ' and -type:postcode' });\r\n        this.fetchJson(url)\r\n            .then(json => {\r\n                if (json.response.numFound < 1) throw('notfound');\r\n                return json.response.docs.shift();\r\n            })\r\n            .then(place => this.mark(place))\r\n            .catch(error => this.fire(error));\r\n    }\r\n});\r\n\r\nL.Map.include({\r\n    find(address) {\r\n        this._geocoder.geocode(address);\r\n        return this;\r\n    },\r\n\r\n    initFinder(buttonId, inputId, datalistId)   {\r\n        const input = document.getElementById(inputId);\r\n        const datalist = document.getElementById(datalistId);\r\n        input.addEventListener('input', function(e) {\r\n            const v = e.target.value;\r\n            if (v.length >= 2)  {\r\n                this._geocoder.suggest(e.target.value, datalist);\r\n            }\r\n        }.bind(this));\r\n        input.addEventListener('change', function(e) {\r\n            const val = e.target.value,\r\n                opts = datalist.childNodes;\r\n            e.target.value = '';\r\n            for (let i = 0; i < opts.length; i++) {\r\n                if (val.startsWith(opts[i].innerText)) {\r\n                    this._geocoder.lookup(opts[i].dataset.id);\r\n                    return;\r\n                }\r\n            }\r\n            this.find(val);\r\n        }.bind(this));\r\n        return this;\r\n    },\r\n\r\n    initGeocoder(name, options)  {\r\n        this._geocoder = new L.geo[name](this, options);\r\n        return this;\r\n    }\r\n});\r\n\r\nL.Map.addInitHook(function() {\r\n    this.initGeocoder('Nominatim', {});\r\n});\r\n","/**\r\n * sjaakp/yii2-locator\r\n * ----------\r\n * Leaflet wrapper for Yii2 framework\r\n * Version 1.0.0\r\n * Copyright (c) 2020\r\n * Sjaak Priester, Amsterdam\r\n * MIT License\r\n * https://github.com/sjaakp/yii2-locator\r\n * https://sjaakpriester.nl\r\n */\r\n\r\n/*\r\n    Plugin for Leaflet\r\n    Tested with Leaflet 1.6.0\r\n    21-05-2018 ... 29-12-2019\r\n\r\n    Map has extra options:\r\n        marker      Plain object, options used for creating markers\r\n                        the option 'type' determines the type of marker (Marker, CircleMarker, DotMarker, SpriteMarker)\r\n                        the option 'icon' is a plain object with options to create the icon for a regular Marker (i.e. not the icon itself)\r\n        urlTemplate     String, url jumped to or used to get popup contents when marker is clicked. If not set, no jump is performed.\r\n                        '{xxx}' gets replaced by Marker option <xxx>\r\n                        typical use: urlTemplate = '/view/{id}'\r\n        cluster     null|object. MarkerClusterer options; null: no clusters.\r\n        popup       null|object. Popup options; null: no popups.\r\n        touchdrag   Boolean. If true, map can only be panned with two fingers; warning overlay appears if attempted with one finger.\r\n                        Intended to avoid conflict with page scrolling on small devices.\r\n        scale       null: no scale | 1: metric scale | 2: imperial scale | 3: both.\r\n\r\n    Two new classes:\r\n\r\n    DotMarker is an extension of CircleMarker. It gets the HTML class 'dot-marker'.\r\n\r\n    SpriteMarker is a Marker with a DivIcon. It has all the options of DivIcon. It gets the HTML class 'sprite-marker'.\r\n        Typical use: set the 'html' option to a SVG-element, either with an explicit path or a use class; use the option 'className' to colorize the sprite\r\n\r\n    Marker, CircleMarker, DotMarker, SpriteMarker each have extra options\r\n        monitor     String, the id of a HTML text input updated at moveend\r\n        title       HTML of tooltip\r\n\r\n    @link https://leafletjs.com/\r\n    @link http://www.liedman.net/tiled-maps/ - The Hitchhacker’s Guide To Tiled Maps\r\n */\r\n\r\nimport './touchdrag.js';\r\nimport './dotmarker.js';\r\nimport './spritemarker.js';\r\nimport './geo.js';\r\n\r\nL.Map.addInitHook(function() {\r\n    if (this.options.scale !== null) {\r\n        const s = this.options.scale,\r\n            metric = s & 1,\r\n            imperial = s & 2;\r\n        this.addControl(L.control.scale({ metric: metric, imperial: imperial }));    // add scale control\r\n    }\r\n    if (this.options.touchdrag) this.addHandler('touchdrag', L.TouchDragHandler);       // and touchdrag handler\r\n});\r\n\r\n\r\nL.Map.include({\r\n\r\n    _markers: null,\r\n    _armed: false,      // true if click on map produces a marker\r\n\r\n    getMarkers()  {\r\n        if (! this._markers)    {\r\n            if (this.options.cluster !== null)  {\r\n                this._markers = L.markerClusterGroup(this.options.cluster);\r\n                this.addLayer(this._markers);\r\n            }\r\n            else this._markers = this;\r\n        }\r\n        return this._markers;\r\n    },\r\n\r\n    arm(markerOpts) {       // prepare for marker on click\r\n        if (! this._armed)  {\r\n            L.DomUtil.addClass(this.getContainer(), 'locator-armed');\r\n            this.options.marker = markerOpts;\r\n            this.on('click', function(e) {\r\n                this.disarm();\r\n                return this.addMarker(e.latlng, markerOpts);\r\n            });\r\n            this._armed = true;\r\n        }\r\n        return this;\r\n    },\r\n\r\n    disarm() {\r\n        if (this._armed)    {\r\n            L.DomUtil.removeClass(this.getContainer(), 'locator-armed');\r\n            this.off('click');\r\n            this._armed = false;\r\n        }\r\n        return this;\r\n    },\r\n\r\n    addFeature(feature)   {\r\n        this.getMarkers().addLayer(L.geoJSON(feature, {\r\n            pointToLayer: function(ft, latlng) {\r\n                return this.newMarker(latlng, Object.assign({}, this.options.marker, ft.properties));\r\n            }.bind(this),\r\n        }));\r\n        return this;\r\n    },\r\n\r\n    monitorZoom(id) {\r\n        return this.on('zoomend', function(e) {\r\n            document.getElementById(id).value = e.target.getZoom();\r\n        }).fire('zoomend');\r\n    },\r\n\r\n    monitorCenter(id) {\r\n        return this.on('moveend', function(e) {\r\n            const c = e.target.getCenter();\r\n            document.getElementById(id).value = JSON.stringify({\r\n                type: 'Point',\r\n                coordinates: [c.lng, c.lat]\r\n            });\r\n        }).fire('moveend');\r\n    },\r\n\r\n    newMarker(latlng, options) {      // create a new marker of any type\r\n        const type = options.type || 'Marker';\r\n        if (type === 'Marker' && options.icon)  {\r\n            options.icon = L.icon(options.icon);\r\n        }\r\n        let r = new L[type](latlng, options).on('moveend', function(e) {\r\n            const id = e.target.options.monitor;\r\n            if (id) {\r\n                document.getElementById(id).value = JSON.stringify(e.target.toGeoJSON());\r\n            }\r\n        }).on('click', function (e)    {\r\n            let url = this.options.urlTemplate;\r\n            if (url)  {\r\n                let matches = url.match(/{\\w+}/g);\r\n                if (matches)    {\r\n                    matches.forEach(function(match) {\r\n                        url = url.replace(match, e.target.options[match.slice(1, -1)]);\r\n                    }, this);\r\n                }\r\n                if (this.options.popup !== null)   {\r\n                    const pOpts = this.options.popup,\r\n                        popup = L.popup(pOpts).setLatLng(e.latlng).setContent(pOpts.loading).openOn(this);\r\n\r\n                    fetch(url)\r\n                        .then(response => response.text())\r\n                        .then(html => popup.setContent(html));\r\n                }\r\n                else    {\r\n                    window.location = url;\r\n                }\r\n            }\r\n        }, this);   // context = map\r\n\r\n        if (options.title)  {\r\n            r.bindTooltip(options.title);\r\n        }\r\n        return r;\r\n    },\r\n\r\n    addMarker(latlng, markerOpts)  {\r\n        const m = this.newMarker(latlng, markerOpts);\r\n        this.addLayer(m);\r\n        this._marker = m;\r\n        m.fire('moveend');\r\n        return this;\r\n    },\r\n\r\n    placeMarker(latlng, bbox)   {\r\n        if (this._marker)    {\r\n            this._marker.setLatLng(latlng);\r\n        }\r\n        else {\r\n            this.disarm().addMarker(latlng, this.options.marker);\r\n        }\r\n        if (this.options.fly)   {\r\n            if (bbox) this.flyToBounds(bbox);\r\n            else this.flyTo(latlng);\r\n        } else  {\r\n            if (bbox) this.fitBounds(bbox);\r\n            else this.panTo(latlng);\r\n        }\r\n    },\r\n});\r\n"],"names":["L","TouchDragHandler","Handler","extend","addHooks","this","_map","dragging","disable","tap","_container","addEventListener","_handleTouch","DomEvent","on","removeHooks","enable","removeEventListener","off","e","type","touches","length","DomUtil","addClass","target","removeClass","DotMarker","CircleMarker","initialize","latlng","options","let","cl","className","prototype","call","Object","assign","radius","weight","fillOpacity","dotMarker","SpriteMarker","Marker","icon","divIcon","html","iconSize","bgPos","spriteMarker","geo","Geocoder","Class","map","setOptions","constructUrl","text","const","opts","url","URL","k","searchParams","set","fetchJson","fetch","href","then","response","json","placeMarker","bbox","fire","err","suggest","address","datalist","lookup","id","Nominatim","mark","place","latLng","lat","lon","bb","boundingbox","latLngBounds","geocode","encodeURIComponent","catch","error","Here","pos","displayPosition","latitude","longitude","mapv","mapView","tl","topLeft","br","bottomRight","fetchData","jsonattributes","view","shift","result","location","query","suggestions","innerHTML","reduce","a","v","locationid","searchtext","GeoNames","fetchGeonames","geonames","lng","north","west","south","east","q","style","geonameId","inclBbox","TomTom","position","viewport","topLeftPoint","btmRightPoint","fetchResults","typeahead","summary","numResults","results","found","find","Kadaster","centroide_ll","match","reverse","numFound","highlighting","hilight","docs","Map","include","_geocoder","initFinder","buttonId","inputId","datalistId","input","document","getElementById","value","bind","val","childNodes","i","startsWith","innerText","dataset","initGeocoder","name","addInitHook","scale","s","metric","imperial","addControl","control","touchdrag","addHandler","_markers","_armed","getMarkers","cluster","markerClusterGroup","addLayer","arm","markerOpts","getContainer","marker","disarm","addMarker","addFeature","feature","geoJSON","pointToLayer","ft","newMarker","properties","monitorZoom","getZoom","monitorCenter","c","getCenter","JSON","stringify","coordinates","r","monitor","toGeoJSON","urlTemplate","matches","forEach","replace","slice","popup","pOpts","setLatLng","setContent","loading","openOn","window","title","bindTooltip","m","_marker","fly","flyToBounds","flyTo","fitBounds","panTo"],"mappings":"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"}